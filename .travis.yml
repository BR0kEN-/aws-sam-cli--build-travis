os: linux
dist: xenial
language: python

python:
  - 3.7

cache:
  - pip

addons:
  apt:
    update: true

env:
  jobs:
    - SAM_RUNTIME=nodejs12.x
    - SAM_RUNTIME=python3.7

install:
  - apt-get install --only-upgrade docker-ce -y
  - docker info
  - pip3 install aws-sam-cli

script:
  - sam build --use-container --debug --template "sam--$SAM_RUNTIME.yml"

# This block will be executed even if the "script" fails.
# Here we show there is not issue with Travis and the
# image can be downloaded.
after_script:
  - docker pull "amazon/aws-sam-cli-build-image-$SAM_RUNTIME"
  - docker inspect "amazon/aws-sam-cli-build-image-$SAM_RUNTIME"
